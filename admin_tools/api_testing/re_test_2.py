# -*- coding: utf-8 -*-
"""
Author       : ChenKui
Email        : kuichen1@lenovo.com
Version      : V1.0
CreateDate   : 2024/10/29 下午2:02 星期二
Project      : AdminTools
FilePath     : admin_tools/api_testing/re_test_2
Description  : 
Copyright    : Copyright (c) 2024 ChenKui, All Rights Reserved.
"""
import re

text = """
{
    "status": "success",
    "data": "let\n    Source = SharePoint.Files(https://lenovobeijing.sharepoint.com/sites/DAProgramDevelopment, [ApiVersion = 15]),\n    #Filtered Rows = Table.SelectRows(Source, each ([Folder Path] = https://lenovobeijing.sharepoint.com/sites/DAProgramDevelopment/Shared Documents/Projects/08.2022.GEHT/GEHT- ExpenseReport/WD/)),\n    #Filtered Hidden Files1 = Table.SelectRows(#Filtered Rows, each [Attributes]?[Hidden]? &lt;&gt; true),\n    #Invoke Custom Function1 = Table.AddColumn(#Filtered Hidden Files1, Transform File, each #Transform File([Content])),\n    #Renamed Columns1 = Table.RenameColumns(#Invoke Custom Function1, {Name, Source.Name}),\n    #Removed Other Columns1 = Table.SelectColumns(#Renamed Columns1, {Source.Name, Transform File}),\n    #Expanded Table Column1 = Table.ExpandTableColumn(#Removed Other Columns1, Transform File, Table.ColumnNames(#Transform File(#Sample File))),\n    #Renamed Columns = Table.RenameColumns(#Expanded Table Column1,{{Amex/OOP, Amex/BOC/OOP}}),\n    #Changed Type = Table.TransformColumnTypes(#Renamed Columns,{{Company Name of Customers, type text}}),\n    #Added Index = Table.AddIndexColumn(#Changed Type, Index, 1, 1, Int64.Type),\n    #Changed Type1 = Table.TransformColumnTypes(#Added Index,{{Activity Date, type date}, {OOP Transaction Date, type date}})\nin\n    #Changed Type1let\n    Source = SharePoint.Files(https://lenovobeijing.sharepoint.com/sites/DAProgramDevelopment, [ApiVersion = 15]),\n    #Filtered Rows = Table.SelectRows(Source, each ([Folder Path] = https://lenovobeijing.sharepoint.com/sites/DAProgramDevelopment/Shared Documents/Projects/08.2022.GEHT/GEHT- ExpenseReport/Concur Data/)),\n    #Filtered Hidden Files1 = Table.SelectRows(#Filtered Rows, each [Attributes]?[Hidden]? &lt;&gt; true),\n    #Invoke Custom Function1 = Table.AddColumn(#Filtered Hidden Files1, Transform File (5), each #Transform File (5)([Content])),\n    #Renamed Columns1 = Table.RenameColumns(#Invoke Custom Function1, {Name, Source.Name}),\n    #Removed Other Columns1 = Table.SelectColumns(#Renamed Columns1, {Source.Name, Transform File (5)}),\n    #Expanded Table Column1 = Table.ExpandTableColumn(#Removed Other Columns1, Transform File (5), Table.ColumnNames(#Transform File (2)(#Sample File (2)))),\n    #Added Index = Table.AddIndexColumn(#Expanded Table Column1, Index, 1, 1, Int64.Type),\n    #Removed Columns = Table.RemoveColumns(#Added Index,{Amex/OOP, Vendor ID, Employee E-mail Address, Employee Local Name}),\n    #Replaced Value = Table.ReplaceValue(#Removed Columns, 00:00:00.0,,Replacer.ReplaceText,{Activity Date}),\n    #Replaced Value1 = Table.ReplaceValue(#Replaced Value, 00:00:00,,Replacer.ReplaceText,{Activity Date})\nin\n    #Replaced Value1let\n    Source = SharePoint.Files(https://lenovobeijing.sharepoint.com/sites/DAProgramDevelopment, [ApiVersion = 15]),\n    #Filtered Rows = Table.SelectRows(Source, each ([Folder Path] = https://lenovobeijing.sharepoint.com/sites/DAProgramDevelopment/Shared Documents/Projects/08.2022.GEHT/GEHT- ExpenseReport/Govt. -Keywords/)),\n    #Keywords xlsx_https://lenovobeijing sharepoint com/sites/DAProgramDevelopment/Shared Documents/Projects/08 2022 GEHT/GEHT- ExpenseReport/Govt  -Keywords/ = #Filtered Rows{[Name=Keywords.xlsx,#Folder Path=https://lenovobeijing.sharepoint.com/sites/DAProgramDevelopment/Shared Documents/Projects/08.2022.GEHT/GEHT- ExpenseReport/Govt. -Keywords/]}[Content],\n    #Imported Excel Workbook = Excel.Workbook(#Keywords xlsx_https://lenovobeijing sharepoint com/sites/DAProgramDevelopment/Shared Documents/Projects/08 2022 GEHT/GEHT- ExpenseReport/Govt  -Keywords/),\n    Keywords_Sheet = #Imported Excel Workbook{[Item=Keywords,Kind=Sheet]}[Data],\n    #Promoted Headers = Table.PromoteHeaders(Keywords_Sheet, [PromoteAllScalars=true]),\n    #Changed Type = Table.TransformColumnTypes(#Promoted Headers,{{Keywords, type text}}),\n    #Added Custom = Table.AddColumn(#Changed Type, Key, each 1)\nin\n    #Added Customlet\n    Source = SharePoint.Files(https://lenovobeijing.sharepoint.com/sites/DAProgramDevelopment, [ApiVersion = 15]),\n    #Filtered Rows = Table.SelectRows(Source, each ([Name] = 企业名单_test.xlsx)),\n    #Filtered Hidden Files1 = Table.SelectRows(#Filtered Rows, each [Attributes]?[Hidden]? &lt;&gt; true),\n    #Invoke Custom Function1 = Table.AddColumn(#Filtered Hidden Files1, Transform File (4), each #Transform File (4)([Content])),\n    #Renamed Columns1 = Table.RenameColumns(#Invoke Custom Function1, {Name, Source.Name}),\n    #Removed Other Columns1 = Table.SelectColumns(#Renamed Columns1, {Source.Name, Transform File (4)}),\n    #Expanded Table Column1 = Table.ExpandTableColumn(#Removed Other Columns1, Transform File (4), Table.ColumnNames(#Transform File (4)(#Sample File (4)))),\n    #Changed Type = Table.TransformColumnTypes(#Expanded Table Column1,{{Source.Name, type text}, {企业名称, type text}, {企业名称 - 企查查搜索结果, type text}, {Tag, type text}, {企业名称相似度, Percentage.Type}}),\n    #Filtered Rows1 = Table.SelectRows(#Changed Type, each ([Tag] &lt;&gt; null))\nin\n    #Filtered Rows1"
}
"""
pattern = r'\[Folder Path\] = (https://[^\)]+)'
regex = re.compile(pattern, re.IGNORECASE)

matches = regex.findall(text)

for match in matches:
    table = match
    print(f"Table: {table}")
